"use strict";(self["webpackChunkairstay"]=self["webpackChunkairstay"]||[]).push([[472],{1362:function(o,t,e){e.d(t,{A:function(){return R}});var l=e(6768),a=e(4232);const s={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},i={class:"modal-dialog",role:"document"},n={class:"modal-content border-0"},d={class:"modal-header bg-danger text-white"},c={class:"modal-title"},r={key:0},m={key:1},u={class:"modal-body"},p={key:0,class:"text-danger"},h={key:1,class:"text-danger"},k={class:"modal-footer"},f=(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function b(o,t,e,b,L,g){return(0,l.uX)(),(0,l.CE)("div",s,[(0,l.Lk)("div",i,[(0,l.Lk)("div",n,[(0,l.Lk)("div",d,[(0,l.Lk)("h5",c,[1===e.infoLength?((0,l.uX)(),(0,l.CE)("span",r,"刪除 "+(0,a.v_)(e.item.title),1)):((0,l.uX)(),(0,l.CE)("span",m,"刪除多筆資料"))])]),(0,l.Lk)("div",u,[(0,l.eW)(" 是否刪除 "),1===e.infoLength?((0,l.uX)(),(0,l.CE)("strong",p,(0,a.v_)(e.item.title),1)):((0,l.uX)(),(0,l.CE)("strong",h,"多筆資料")),(0,l.eW)(" (刪除後將無法恢復)。 ")]),(0,l.Lk)("div",k,[f,(0,l.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>o.$emit("del-item"))}," 確認刪除 ")])])])],512)}var L=e(2894),g=e.n(L),v={data(){return{modal:{},isMany:!1}},mounted(){this.modal=new(g())(this.$refs.modal)},props:{item:{type:Object,default(){return{}}},infoLength:{}},watch:{},methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}}},y=e(1241);const I=(0,y.A)(v,[["render",b]]);var R=I},3472:function(o,t,e){e.r(t),e.d(t,{default:function(){return uo}});var l=e(6768),a=e(4232),s=e(5130),i=e(2009);const n=(0,l.Lk)("img",{src:i,alt:"Loading...",style:{width:"100px"}},null,-1),d=(0,l.Lk)("h3",null,"所有房型列表",-1),c={class:"text-end"},r={class:"table mt-4"},m=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",{width:"180"},"所在地區"),(0,l.Lk)("th",{width:"200"},"飯店名稱"),(0,l.Lk)("th",{width:"200"},"房型"),(0,l.Lk)("th",{width:"80"},"評價"),(0,l.Lk)("th",{width:"80"},"評價數量"),(0,l.Lk)("th",{width:"120"},"原價"),(0,l.Lk)("th",{width:"120"},"售價"),(0,l.Lk)("th",{width:"100"},"是否公開"),(0,l.Lk)("th",{width:"150"},"設定")])],-1),u={class:"text-right"},p={class:"text-right"},h={key:0,class:"text-success"},k={key:1,class:"text-muted"},f={class:"btn-group"},b=["onClick"],L=["onClick"];function g(o,t,e,i,g,v){const y=(0,l.g2)("Loading"),I=(0,l.g2)("DelModal"),R=(0,l.g2)("EditModal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(y,{active:o.isLoading},{default:(0,l.k6)((()=>[n])),_:1},8,["active"]),(0,l.bo)((0,l.Lk)("div",null,[d,(0,l.Lk)("div",c,[(0,l.Lk)("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=(...o)=>v.openEditModal&&v.openEditModal(...o))}," 新增房型 ")]),(0,l.Lk)("table",r,[m,(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.allRoomInfo,(t=>((0,l.uX)(),(0,l.CE)("tr",{key:t.id},[(0,l.Lk)("td",null,(0,a.v_)(t.category),1),(0,l.Lk)("td",null,(0,a.v_)(t.title),1),(0,l.Lk)("td",null,(0,a.v_)(t.content),1),(0,l.Lk)("td",null,(0,a.v_)(t.unit)+" 分",1),(0,l.Lk)("td",null,(0,a.v_)(t.description)+" 則",1),(0,l.Lk)("td",u,(0,a.v_)(o.$numFilter.currency(t.origin_price))+" 元 ",1),(0,l.Lk)("td",p,(0,a.v_)(o.$numFilter.currency(t.price))+" 元 ",1),(0,l.Lk)("td",null,[t.is_enabled?((0,l.uX)(),(0,l.CE)("span",h,"上架")):((0,l.uX)(),(0,l.CE)("span",k,"未上架"))]),(0,l.Lk)("td",null,[(0,l.Lk)("div",f,[(0,l.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:o=>v.openEditModal(t)}," 編輯 ",8,b),(0,l.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:o=>v.openDeleteModal(t)}," 刪除 ",8,L)])])])))),128))])])],512),[[s.aG,g.isLogin]]),(0,l.bF)(I,{ref:"delModal",item:g.curItem,onDelItem:v.delRoomInfo},null,8,["item","onDelItem"]),(0,l.bF)(R,{ref:"editModal",item:g.curItem,onUpdateRoomInfo:v.updateRoomInfo},null,8,["item","onUpdateRoomInfo"])],64)}e(4114);var v=e(1362);const y={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},I={class:"modal-dialog modal-xl",role:"document"},R={class:"modal-content border-0"},x=(0,l.Lk)("div",{class:"modal-header bg-dark text-white"},[(0,l.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l.Lk)("span",null,"新增或編輯房型")])],-1),C={class:"modal-body"},M={class:"row"},w={class:"col-sm-4"},$={class:"mb-3"},U=(0,l.Lk)("label",{for:"image",class:"form-label"},"您想要的圖片網址",-1),_={class:"mb-3"},E=(0,l.Lk)("label",{for:"customFile",class:"form-label"},[(0,l.eW)("或 從您的電腦上傳圖片 "),(0,l.Lk)("i",{class:"fas fa-spinner fa-spin"})],-1),F=(0,l.Lk)("img",{class:"img-fluid",alt:""},null,-1),X={class:"col-sm-8"},V={class:"mb-3"},J=(0,l.Lk)("label",{for:"title",class:"form-label"},"飯店名稱",-1),A={class:"mb-3"},D=(0,l.Lk)("label",{for:"category",class:"form-label"},"所在地區",-1),j={class:"row gx-2"},O={class:"mb-3 col-md-6"},W=(0,l.Lk)("label",{for:"unit",class:"form-label"},"評價分數",-1),K={class:"mb-3 col-md-6"},z=(0,l.Lk)("label",{for:"description",class:"form-label"},"評價數量",-1),G={class:"row gx-2"},H={class:"mb-3 col-md-6"},T=(0,l.Lk)("label",{for:"origin_price",class:"form-label"},"原價",-1),q={class:"mb-3 col-md-6"},B=(0,l.Lk)("label",{for:"price",class:"form-label"},"售價",-1),N=(0,l.Lk)("hr",null,null,-1),P={class:"mb-3"},Q=(0,l.Lk)("label",{for:"content",class:"form-label"},"房型",-1),S={class:"mb-3"},Y={class:"form-check"},Z=(0,l.Lk)("label",{class:"form-check-label",for:"is_enabled"}," 是否上架 ",-1),oo={class:"modal-footer"},to=(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function eo(o,t,e,a,i,n){return(0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",I,[(0,l.Lk)("div",R,[x,(0,l.Lk)("div",C,[(0,l.Lk)("div",M,[(0,l.Lk)("div",w,[(0,l.Lk)("div",$,[U,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結",onChange:t[0]||(t[0]=(...o)=>n.uploadUrl&&n.uploadUrl(...o)),"onUpdate:modelValue":t[1]||(t[1]=o=>i.onlineUrl=o)},null,544),[[s.Jo,i.onlineUrl]])]),(0,l.Lk)("div",_,[E,(0,l.Lk)("input",{type:"file",id:"customFile",class:"form-control",onChange:t[2]||(t[2]=(...o)=>n.uploadFile&&n.uploadFile(...o)),ref:"fileInput"},null,544)]),F]),(0,l.Lk)("div",X,[(0,l.Lk)("div",V,[J,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入飯店名稱","onUpdate:modelValue":t[3]||(t[3]=o=>i.tempRoomInfo.title=o)},null,512),[[s.Jo,i.tempRoomInfo.title]])]),(0,l.Lk)("div",A,[D,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入所在地區","onUpdate:modelValue":t[4]||(t[4]=o=>i.tempRoomInfo.category=o)},null,512),[[s.Jo,i.tempRoomInfo.category]])]),(0,l.Lk)("div",j,[(0,l.Lk)("div",O,[W,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入評價分數","onUpdate:modelValue":t[5]||(t[5]=o=>i.tempRoomInfo.unit=o)},null,512),[[s.Jo,i.tempRoomInfo.unit]])]),(0,l.Lk)("div",K,[z,(0,l.bo)((0,l.Lk)("input",{type:"number",class:"form-control",id:"description",placeholder:"請輸入評價數量","onUpdate:modelValue":t[6]||(t[6]=o=>i.tempRoomInfo.description=o)},null,512),[[s.Jo,i.tempRoomInfo.description]])])]),(0,l.Lk)("div",G,[(0,l.Lk)("div",H,[T,(0,l.bo)((0,l.Lk)("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":t[7]||(t[7]=o=>i.tempRoomInfo.origin_price=o)},null,512),[[s.Jo,i.tempRoomInfo.origin_price]])]),(0,l.Lk)("div",q,[B,(0,l.bo)((0,l.Lk)("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":t[8]||(t[8]=o=>i.tempRoomInfo.price=o)},null,512),[[s.Jo,i.tempRoomInfo.price]])])]),N,(0,l.Lk)("div",P,[Q,(0,l.bo)((0,l.Lk)("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入房型詳細資訊","onUpdate:modelValue":t[9]||(t[9]=o=>i.tempRoomInfo.content=o)},null,512),[[s.Jo,i.tempRoomInfo.content]])]),(0,l.Lk)("div",S,[(0,l.Lk)("div",Y,[(0,l.bo)((0,l.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[10]||(t[10]=o=>i.tempRoomInfo.is_enabled=o)},null,512),[[s.lH,i.tempRoomInfo.is_enabled]]),Z])])])])]),(0,l.Lk)("div",oo,[to,(0,l.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[11]||(t[11]=t=>o.$emit("update-roomInfo",i.tempRoomInfo))}," 確認 ")])])])],512)}var lo=e(2894),ao=e.n(lo),so={data(){return{tempRoomInfo:{},modal:{},onlineUrl:"",uploadedFile:[]}},mounted(){this.modal=new(ao())(this.$refs.modal)},props:{item:{type:Object,default(){return{}}}},watch:{item(){this.tempRoomInfo=this.item}},methods:{uploadFile(){this.uploadedFile=this.$refs.fileInput.files[0];const o=new FormData;o.append("file-to-upload",this.uploadedFile);const t="https://vue3-course-api.hexschool.io/api/airstay/admin/upload";this.$http.post(t,o).then((o=>{o.data.success?(this.tempRoomInfo.imageUrl=o.data.imageUrl,console.log("上傳圖片成功")):console.log("上傳圖片失敗")}))},uploadUrl(){this.tempRoomInfo.imageUrl=this.onlineUrl},showModal(){this.onlineUrl="",this.modal.show()},hideModal(){this.modal.hide()}}},io=e(1241);const no=(0,io.A)(so,[["render",eo]]);var co=no,ro={components:{DelModal:v.A,EditModal:co},data(){return{isLogin:!1,allRoomInfo:[],delComponent:{},editComponent:{},curItem:{}}},created(){this.isLoading=!0;const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=o;const t="https://vue3-course-api.hexschool.io/api/user/check";this.$http.post(t,this.user).then((o=>{o.data.success?this.isLogin=!0:this.$router.push("/dashboard/login"),this.isLoading=!1})),this.getRoomInfo()},mounted(){this.editComponent=this.$refs.editModal,this.delComponent=this.$refs.delModal},methods:{getRoomInfo(){const o="https://vue3-course-api.hexschool.io/api/airstay/admin/products/all";this.isLoading=!0,this.$http.get(o).then((o=>{o.data.success?(this.allRoomInfo=o.data.products,console.log("[後台] 取得房間列表成功",o.data)):console.log("[後台] 取得房間列表失敗"),this.isLoading=!1}))},delRoomInfo(){const o=`https://vue3-course-api.hexschool.io/api/airstay/admin/product/${this.curItem.id}`;this.isLoading=!0,this.$http.delete(o).then((o=>{o.data.success?(this.delComponent.hideModal(),this.getRoomInfo(),console.log("[後台] 刪除房間列表成功",o.data)):console.log("[後台] 刪除房間列表失敗"),this.$httpMessage(o,"刪除房間列表"),this.isLoading=!1}))},updateRoomInfo(o){let t="https://vue3-course-api.hexschool.io/api/airstay/admin/product",e="post",l="新增房型";Object.keys(this.allRoomInfo).forEach((a=>{a===o.id&&(t=`https://vue3-course-api.hexschool.io/api/airstay/admin/product/${o.id}`,e="put",l="編輯房型")}));const a=o;this.isLoading=!0,this.$http[e](t,{data:a}).then((o=>{o.data.success?(this.editComponent.hideModal(),this.getRoomInfo(),console.log("[後台] 新增房型成功",o.data)):console.log("[後台] 新增房型失敗",o.data.message),this.$httpMessage(o,l),this.isLoading=!1}))},openEditModal(o){this.curItem={...o},this.editComponent.showModal()},openDeleteModal(o){this.curItem={...o},this.delComponent.showModal()}}};const mo=(0,io.A)(ro,[["render",g]]);var uo=mo},2009:function(o,t,e){o.exports=e.p+"img/loadingAni.04376c8d.gif"}}]);
//# sourceMappingURL=472.b73a1d9d.js.map